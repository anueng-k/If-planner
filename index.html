<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IF Planner</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-teal-500 to-emerald-500 min-h-screen flex items-center justify-center text-slate-800">

<div class="w-full max-w-sm bg-white rounded-3xl shadow-2xl p-6 space-y-6">

<!-- HEADER -->
<div class="text-center">
<div class="text-2xl font-bold">IF Planner</div>
<div class="text-sm text-slate-500">ควบคุมการกินง่าย ๆ</div>
</div>

<!-- TIMER CARD -->
<div id="card" class="p-6 rounded-2xl text-center border-2">
<div id="phase" class="text-sm font-bold mb-2"></div>
<div id="timer" class="text-4xl font-bold">00:00:00</div>
</div>

<!-- PLAN -->
<div>
<div class="text-sm font-bold mb-2">เลือกระบบ</div>
<div class="grid grid-cols-3 gap-2">
<button onclick="setPlan(16)" class="btn">16/8</button>
<button onclick="setPlan(18)" class="btn">18/6</button>
<button onclick="setPlan(20)" class="btn">20/4</button>
</div>
</div>

<!-- START TIME -->
<div>
<div class="text-sm font-bold mb-2">เริ่มกิน</div>
<input type="time" id="startTime" class="w-full p-3 rounded-xl border text-center text-lg">
</div>

<!-- NUTRITION -->
<div class="bg-slate-50 p-4 rounded-2xl">
<div class="font-bold mb-2">โภชนาการต่อวัน</div>
<div id="nutrition" class="text-sm space-y-1"></div>
</div>

</div>

<style>
.btn{
padding:12px;
border-radius:12px;
border:1px solid #ddd;
font-weight:600;
background:white;
}
.btn:active{
transform:scale(0.96);
background:#14b8a6;
color:white;
}
</style>

<script>
let fastingHours = 16;
let startTime = "12:30";

document.getElementById("startTime").value = startTime;

function setPlan(h){
fastingHours = h;
updateTimer();
}

document.getElementById("startTime").addEventListener("change", e=>{
startTime = e.target.value;
updateTimer();
});

function updateTimer(){
const now = new Date();
const [h,m] = startTime.split(":");
let start = new Date();
start.setHours(h,m,0);

let eatingEnd = new Date(start.getTime() + (24-fastingHours)*3600000);
let isEating = now >= start && now < eatingEnd;

let diff;
let phaseText;

if(isEating){
phaseText = "ช่วงเวลากิน";
diff = eatingEnd - now;
card.className="p-6 rounded-2xl text-center border-2 border-emerald-500 bg-emerald-50";
}else{
phaseText = "ช่วงอดอาหาร";
let next = now > eatingEnd ? new Date(start.getTime()+86400000) : start;
diff = next - now;
card.className="p-6 rounded-2xl text-center border-2 border-slate-300 bg-slate-100";
}

phase.innerText = phaseText;
timer.innerText = format(diff);
}

function format(ms){
let s = Math.floor(ms/1000);
let h = Math.floor(s/3600);
let m = Math.floor((s%3600)/60);
let sec = s%60;
return `${h.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}:${sec.toString().padStart(2,"0")}`;
}

setInterval(updateTimer,1000);

function calcNutrition(){
let weight = 70;
let protein = weight * 1.6;
let fat = weight * 0.8;
let water = weight * 35;
let cal = 2000;

nutrition.innerHTML = `
แคลอรี่ ≈ ${cal} kcal<br>
โปรตีน ≈ ${Math.round(protein)} g<br>
ไขมันดี ≈ ${Math.round(fat)} g<br>
น้ำ ≈ ${Math.round(water)} ml<br>
<br>
ตัวอย่างโปรตีน:<br>
ไข่ 3 ฟอง<br>
อกไก่ 150g<br>
ปลา 1 ชิ้นใหญ่
`;
}

calcNutrition();
updateTimer();
</script>

</body>
</html>