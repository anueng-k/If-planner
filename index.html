<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IF Healthy Planner</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-50 text-slate-900">

<div class="max-w-md mx-auto min-h-screen p-4 space-y-6">

<header class="p-6 bg-teal-600 text-white text-center rounded-3xl">
<h1 class="text-xl font-bold">IF Healthy Planner</h1>
</header>

<!-- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
<div id="status-card" class="rounded-3xl p-6 text-center border bg-white">
<p id="phase-label" class="font-bold"></p>
<div id="timer-display" class="text-4xl font-bold">00:00:00</div>
</div>

<!-- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏ú‡∏ô -->
<section class="space-y-3">
<h2 class="font-bold text-slate-500">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏≠‡∏î‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h2>

<div class="flex gap-2">
<input id="fastingInput" type="number" min="10" max="23"
class="border rounded-xl p-3 w-full"
placeholder="‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏≠‡∏î ‡πÄ‡∏ä‡πà‡∏ô 16">

<button onclick="saveFasting()" 
class="bg-teal-600 text-white px-4 rounded-xl">
‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
</button>
</div>
</section>

<!-- ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏ô -->
<section class="space-y-3">
<h2 class="font-bold text-slate-500">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏ô</h2>

<input id="startTimeInput" type="time"
class="border rounded-xl p-3 w-full"
onchange="saveStartTime(this.value)">
</section>

<!-- ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ú‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô -->
<section class="space-y-3">
<h2 class="font-bold text-slate-500">‡πÅ‡∏ú‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h2>
<div id="day-plans" class="space-y-2"></div>
</section>

</div>

<script>
let fastingHours = parseInt(localStorage.getItem("fH")) || 16;
let startStr = localStorage.getItem("sT") || "12:30";
let dayPlans = JSON.parse(localStorage.getItem("dayPlans")) || {};

document.getElementById("fastingInput").value = fastingHours;
document.getElementById("startTimeInput").value = startStr;

function saveFasting(){
fastingHours = parseInt(document.getElementById("fastingInput").value);
localStorage.setItem("fH", fastingHours);
updateUI();
}

function saveStartTime(t){
startStr = t;
localStorage.setItem("sT", t);
updateUI();
}

const days = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];

function renderDayPlans(){
const box = document.getElementById("day-plans");
box.innerHTML = "";

days.forEach((d,i)=>{
const val = dayPlans[i] || fastingHours;

box.innerHTML += `
<div class="flex justify-between items-center bg-white p-3 rounded-xl border">
<span>${d}</span>
<input type="number" min="10" max="23"
value="${val}"
class="border rounded-lg p-1 w-20"
onchange="setDayPlan(${i}, this.value)">
</div>`;
});
}

function setDayPlan(i,v){
dayPlans[i] = parseInt(v);
localStorage.setItem("dayPlans", JSON.stringify(dayPlans));
updateUI();
}

function getTodayPlan(){
const today = new Date().getDay();
return dayPlans[today] || fastingHours;
}

function updateUI(){
const plan = getTodayPlan();

const now = new Date();
const [h,m] = startStr.split(":");

let start = new Date();
start.setHours(h,m,0);

let eatingEnd = new Date(start.getTime() + (24-plan)*3600000);

let isEating = now >= start && now < eatingEnd;

const label = document.getElementById("phase-label");
const timer = document.getElementById("timer-display");

if(isEating){
label.innerText = "üç¥ Eating Window";
timer.innerText = formatTime(eatingEnd-now);
}else{
label.innerText = "üî• Fasting Period";
let target = now > eatingEnd ? new Date(start.getTime()+86400000) : start;
timer.innerText = formatTime(target-now);
}
}

function formatTime(ms){
let s=Math.floor(ms/1000);
let h=Math.floor(s/3600);
let m=Math.floor((s%3600)/60);
let sec=s%60;
return `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${sec.toString().padStart(2,'0')}`;
}

setInterval(updateUI,1000);
renderDayPlans();
updateUI();
</script>

</body>
</html>